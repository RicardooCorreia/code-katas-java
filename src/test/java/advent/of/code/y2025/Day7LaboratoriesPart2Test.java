package advent.of.code.y2025;

import org.junit.jupiter.api.Test;

import static org.assertj.core.api.Assertions.assertThat;

class Day7LaboratoriesPart2Test {

    private final Day7LaboratoriesPart2 subject = new Day7LaboratoriesPart2();

    @Test
    void splitBeam_example() {

        // Given
        String input = """
                .......S.......
                ...............
                .......^.......
                ...............
                ......^.^......
                ...............
                .....^.^.^.....
                ...............
                ....^.^...^....
                ...............
                ...^.^...^.^...
                ...............
                ..^...^.....^..
                ...............
                .^.^.^.^.^...^.
                ...............
                """;

        // When
        long result = subject.splitBeam(input);

        // Then
        assertThat(result)
                .isEqualTo(40);
    }

    @Test
    void splitBeam_puzzle() {

        // Given
        String input = """
                ......................................................................S......................................................................
                .............................................................................................................................................
                ......................................................................^......................................................................
                .............................................................................................................................................
                .....................................................................^.^.....................................................................
                .............................................................................................................................................
                ....................................................................^.^.^....................................................................
                .............................................................................................................................................
                ...................................................................^.^.^.^...................................................................
                .............................................................................................................................................
                ..................................................................^.^.^.^.^..................................................................
                .............................................................................................................................................
                .................................................................^.^...^.^.^.................................................................
                .............................................................................................................................................
                ................................................................^...^...^.^.^................................................................
                .............................................................................................................................................
                ...............................................................^.^...^.^.^...^...............................................................
                .............................................................................................................................................
                ..............................................................^.^.^.^.^.....^.^..............................................................
                .............................................................................................................................................
                .............................................................^.....^.^.^.^...^.^.............................................................
                .............................................................................................................................................
                ............................................................^.^.^...^.^.^.^.^.^.^............................................................
                .............................................................................................................................................
                ...........................................................^...^.^.^.^...^...^...^...........................................................
                .............................................................................................................................................
                ..........................................................^.^.^.^.^.^.....^.^.^...^..........................................................
                .............................................................................................................................................
                .........................................................^...^.^.......^...^.......^.........................................................
                .............................................................................................................................................
                ........................................................^.^...^.^.^.^.^.....^...^.^.^........................................................
                .............................................................................................................................................
                .......................................................^...^...^...^.^...^.^.^.^...^.^.......................................................
                .............................................................................................................................................
                ......................................................^.^.^.^.^...^.^.^...^.^.^.^.^...^......................................................
                .............................................................................................................................................
                .....................................................^.^.^.^.....^...^.........^.^...^.^.....................................................
                .............................................................................................................................................
                ....................................................^.^.^.^.^.^.^.^.^...^.^.^.....^...^.^....................................................
                .............................................................................................................................................
                ...................................................^...^.^...^.^...^.^.^.^.^...^.^.^.^.^.^...................................................
                .............................................................................................................................................
                ..................................................^.....^.^.^...^.^.....^.^...^.^.^.^.^.^.^..................................................
                .............................................................................................................................................
                .................................................^.^.^...^.....^...^...^.^.^.^.^.^.^.^.^...^.................................................
                .............................................................................................................................................
                ................................................^.^...^...^.^...^.^.^...^.^.....^...^.....^.^................................................
                .............................................................................................................................................
                ...............................................^.^.^...^.^.....^...^...^...^.^...^.^.^.......^...............................................
                .............................................................................................................................................
                ..............................................^...^.^...^.......^.^.^.^.^.^.^.^.^...^...^.....^..............................................
                .............................................................................................................................................
                .............................................^...^.^.....^.......^.^.^.^.^.^...^.^.^.^.....^...^.............................................
                .............................................................................................................................................
                ............................................^.^.^.........^.^.....^.^.^.^.^...^.^.^.^.^...^.....^............................................
                .............................................................................................................................................
                ...........................................^.^.^.^...^.....^.^.^.^.^...^...^.^.....^...^...^.^.^.^...........................................
                .............................................................................................................................................
                ..........................................^.....^.^.^.^.^.^...^.....^.^.....^...^...^.^.^.^.^...^.^..........................................
                .............................................................................................................................................
                .........................................^.^...^.^.....^.^...^.^.^.^.^.^.^.^.^.^...^.....^.....^.^.^.........................................
                .............................................................................................................................................
                ........................................^.....^.^.^.^.^.^.^...^...^.^.^.^.......^.^.^.^.^.^.^.^.^.^.^........................................
                .............................................................................................................................................
                .......................................^.^.^.^.^.^.^.^...^.^...^.^.^.^...^...^.....^.^.^...^.^...^.^.^.......................................
                .............................................................................................................................................
                ......................................^.......^.^.........^...^.............^.^.^.^...^.^.^.^.^.^.^.^.^......................................
                .............................................................................................................................................
                .....................................^.^.^...^.^.^.^.....^.^.^...^.^.^.^.....^.^.^.^...^.......^.^...^.^.....................................
                .............................................................................................................................................
                ....................................^...^.^...^.^.^...^.....^...^.......^.^.......^...^...^.^.^.^...^...^....................................
                .............................................................................................................................................
                ...................................^.^.^.^.^.......^.^...^.^...^.^...^.^...^...^.^.^...^.^.^.^.^.^.^.^.^.^...................................
                .............................................................................................................................................
                ..................................^.........^.^.^.^.^...^.^.^...^.^.^...^.^.^.^...^...^.^.^.....^...^.^.^.^..................................
                .............................................................................................................................................
                .................................^.^.^...^...^.^.....^.^.^.^...^.^.^.^.^.^.^...^...^.^.^...^.^.^.^...^.^.^.^.................................
                .............................................................................................................................................
                ................................^.^.....^...^.....^...^.^...^.^.^.^...^...^.^.^.^.^.^...^.^.^.^.^.^.^...^.^.^................................
                .............................................................................................................................................
                ...............................^...^.^...^.^.^...^...^.^.^.^.^.^...^.^.^.^...^.^.^.^.^...^...^...^.^.^.....^.^...............................
                .............................................................................................................................................
                ..............................^.^.....^.^.^.^.....^.^.^.....^.^.^.^.^.^.......^...^.^.^.^.^...^.^.^.^.^.^.^.^.^..............................
                .............................................................................................................................................
                .............................^.^.....^...^.^.^.......^.^...^.^.^...^...^.^...^...^.^...^.^.^.^.^.^.^.^...^.^...^.............................
                .............................................................................................................................................
                ............................^.....^.^...^.^.^.......^.^.^.^.......^.^.^.^.^.^.^...^.^.^.^...^...^.......^.^.^.^.^............................
                .............................................................................................................................................
                ...........................^.^.^...^...^.^.^.^...^.^.^.^.^.....^...^...^.....^...^.^.^.^.^.........^.^.....^.^.^.^...........................
                .............................................................................................................................................
                ..........................^.^...^.^...^.^.^.^.......^.^.^.^.^...^.^.....^.^.^.....^.....^...^.......^.^.^.^.^.....^..........................
                .............................................................................................................................................
                .........................^.^.^.^.....^.^...^.^.^.^.^.^.^.^...^.^.^.....^.^.^...^.^...^.^...^...^...^...^.^.^.^...^.^.........................
                .............................................................................................................................................
                ........................^.^.^...^.^.^.^...^.....^...^.^.^.^.^.^...^.....^.^.^.^.^.^...^...^.^...........^...^...^...^........................
                .............................................................................................................................................
                .......................^.^...^.^.^.^.^.^.^.^.^.^.^.^.^.^...^.......^.^.^.^.^.^...^...^...^.^.^.^.^.......^.^.^.^.^.^.^.......................
                .............................................................................................................................................
                ......................^.......^.^.^.^...^.^...^.^...^.^...^.^.^.^.^...^.^.^...^...^.^...^...^.^.^.^.^.^.^.^.^.....^.^.^......................
                .............................................................................................................................................
                .....................^...^.....^.^.....^.^.^.^...^.^.^.....^.....^.^.^...^...^.^.^.....^.^.^.^.^.^.^.^.^.^.^.^.^.^.^...^.....................
                .............................................................................................................................................
                ....................^...^...^.^.^.^...^.^...^.^.^.^...^...^.^.^.^...^.^.^.^.^...^.^.......^.^.^.^...^...^.....^.^.....^.^....................
                .............................................................................................................................................
                ...................^...^.^.^.^...^...^.^.....^...^.^.^.^.^.^.^.^.^.^.....^.^...^.....^...^.^...^.^...^.^.^.^.^...^.^...^.^...................
                .............................................................................................................................................
                ..................^.^.....^...^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.....^.^.^.^.^.....^.^.^.^...^.^...^.^.^.^.^..................
                .............................................................................................................................................
                .................^.^...^.^.^.^.^.^.^.^.^...^.^.....^.....^.^.^.^...^.^.^.^...^...^...^.^.^.^.^.^.^.......^.....^.^.....^...^.................
                .............................................................................................................................................
                ................^.^.^.........^...^.^...^.^.^.^.^.^...^...^...^.^.^...^.^.......^.^.^...^...^.^.^.^.^.^...^...^.....^.^.....^................
                .............................................................................................................................................
                ...............^.^.......^.^.^.^...^.^.^...^.^...^.^.^.^...^.....^.^.....^.^.^.....^.^.^.^.^.^.^.^.^.^.^.^...^.^...^.^.....^.^...............
                .............................................................................................................................................
                ..............^.^.^.^...^.....^.^.^.^.^.^...^...^.^.^.^...^.^.....^.^...^.....^.^...^...^...^.^.^...^.^.....^...^.^.^.^.^.^.^.^..............
                .............................................................................................................................................
                .............^.^.^.^.^.^.^.^.^.....^...^...^...^.......^.^.^...^...^...^.^...^...^.....^.^.......^.^.....^...^...^.....^.^.^.^.^.............
                .............................................................................................................................................
                ............^.^.......^.....^.^.^.^.^.^.^.^.^.^.....^.^.^...^.^.^.^.^.^...^.......^.^.^...^...^...^...........^.^.^.^...^...^.^.^............
                .............................................................................................................................................
                ...........^...^.^.....^.^.^.^.^.^...^.....^...^...^.^.^.^.^.^...^.^.^.^.^.^.^...^.....^.^.^.....^...^.^.^.^.....^.^.^.^.......^.^...........
                .............................................................................................................................................
                ..........^.^...^...^.^.^.^.^.^.....^.........^...^.^.^.^.^.^...^.^.^.........^.^.^.^.^...^...^.^.^.^.^...^.^.^.^...^.^.^.^.^...^.^..........
                .............................................................................................................................................
                .........^.^.^...^.......^.^.^.^.^.....^...^.^...^...^.^...^...^...^.^.^.^.^.^.^.^.^.^.^.....^...^.^.^.....^...^.^.^.^.....^...^.^.^.........
                .............................................................................................................................................
                ........^.^...^.^.^.^...^...^.....^...^.^.^.....^.^...^.^.^.^.^...^.....^...^.^...^.^.....^.....^.^.^.^...^.^.....^.^.^.....^.^.^.^.^........
                .............................................................................................................................................
                .......^.^.^.^.....^.........^...^.........^.^.....^.^.^.^.^.^.....^.^.^...^.^...^.^.^.^.^.^.....^.^.^.^.^.^...^.......^.^...^.^.^.^.^.......
                .............................................................................................................................................
                ......^.^.^.....^.^.^.^.^.^...^.^.....^.^.^.^.^...^...^.^.........^.^...^.^.^.^.^.^.^.^.......^.^.^.^.....^...^...^...^...^.^.....^...^......
                .............................................................................................................................................
                .....^.^.....^.^.^.^.^.^.^.^.....^.^...^.^.^...^.....^...^.^.^.^.^.^...^.............^.^.^...^.^.....^.^.....^.^.....^.^.^.^.^.^.....^.^.....
                .............................................................................................................................................
                ....^.^.^.^.^...^.^...^.......^.^.^.^.^...^.^.^...^.^.^.^.^.^.^.^...^.^.^.^.^...^.^.^.^.^.^...^...^.....^.^.^...^.^...^.^.^...^.^...^.^.^....
                .............................................................................................................................................
                ...^.^.^.^.^.^.....^...^...^.^...^...^.^...^.^...^.^.^.^.......^...^.^.^...^...^.^.^...^.^.^.^...^...^.^.^...^.^.^.^.^.^.^.^.^...^...^.^.^...
                .............................................................................................................................................
                ..^.^.^...^.^.........^.^...^.^.^.^.^.......^.^.....^...^.....^...^...^...^.....^.^.^.....^...^.....^.......^.^.^...^.^.....^.^.....^.^.^.^..
                .............................................................................................................................................
                .^.^.^.^.^...^...^...^.^...^.^...^.^.^.^.....^.^.^.^.....^.^...^.^.^.^.^.^.^...........^.^.^.^.......^.^.^.^.^...^.^.^.^.^.^.^.^.....^.^...^.
                .............................................................................................................................................""";

        // When
        long result = subject.splitBeam(input);

        // Then
        assertThat(result)
                .isEqualTo(15811946526915L);
    }
}
